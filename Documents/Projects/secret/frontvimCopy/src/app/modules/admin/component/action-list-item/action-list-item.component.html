<ng-container *ngIf="levelActions.length>0">
<div *ngFor="let action of levelActions;" [class]="action.parent?'action-list-item':''"> 
    <nz-list nzBordered nzSize="small" >
      <li nz-list-item  nzNoFlex [class]="action.canAccess||editMode?'activeItem':''">
        <ul nz-list-item-actions *ngIf="!(action.canAccess && !action.assigned)" style="margin-bottom: 0;">          
          <nz-list-item-action >
            <button *ngIf="editMode" nz-icon nzType="plus-square" class="d-inline btn btn-sm btn-outline-success" (click)="addChild(action)"></button>
            <nz-switch *ngIf="!editMode" nzSize="small" 
                  [ngModel]="action.assigned" 
                  [nzCheckedChildren]="checkedTemplate" 
                  [nzUnCheckedChildren]="unCheckedTemplate"
                  (click)="onClickSwitch(action._id,rol);">
            </nz-switch>
          </nz-list-item-action>
        </ul>
        <i *ngIf="(action.showChilds && action.hasChilds)" class="clsCollapse" nz-icon nzType="minus-square" nzTheme="outline" (click)="actionCollapse(action._id)"></i>
        <i *ngIf="(!action.showChilds) && action.hasChilds" class="clsCollapse" nz-icon nzType="plus-square" nzTheme="outline" (click)="actionCollapse(action._id)"></i> {{ action.name }}
        <code *ngIf="editMode">{{action._id}}</code>
      </li>
    </nz-list>

    <div *ngIf="action.newChild" class="action-list-item"> 
      <nz-list nzBordered nzSize="small">
        <li  nz-list-item  nzNoFlex>         
          <form nz-form [formGroup]="formData" [nzLayout]="'inline'"   autocomplete="off">
            <nz-form-item>
              <nz-form-control nzErrorTip="La clave debe estar integrada unicamente por valores alfanuméricos." [nzValidateStatus]="formData.controls['nameId']">
                <nz-form-control nzErrorTip="El id Hex debe ser de 12 caracteres alfanuméricos." [nzValidateStatus]="formData.controls['hexId']">
                  <nz-input-group nzCompact nzSearch [nzAddOnAfter]="suffixIconButton">
                    <input nz-input type="text" formControlName="nLevel" id="nlevel" nzSize="small" style="width:10%;"/>
                    <input nz-input type="text" formControlName="nameId" id="nameId" nzSize="small" placeholder="clave_del_id"style="width:60%;" />
                    <input nz-input type="text" formControlName="hexId"  id="hexId"  nzSize="small" placeholder="_id hex unico" style="width:30%;" />
                  </nz-input-group> 
                  <ng-template #suffixIconButton>
                    <span nz-icon nzType="number" class="d-inline btn btn-custom-extra" (click)="setUniqueHex()"></span>
                  </ng-template>                
                </nz-form-control>
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-control nzErrorTip="Escriba un nombre válido">
                <nz-input-group >
                  <input nz-input type="test" formControlName="name"  placeholder="Nombre" nzSize="small" />
                </nz-input-group>
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-control>
                <button type="button" class="btn btn-custom-extra" (click)="onSaveAction(action)" [disabled]="formData.invalid">Registrar</button>
              </nz-form-control>
            </nz-form-item>
          </form>
        </li>
      </nz-list>
    </div>

    <app-action-list-item *ngIf="action.showChilds" [actionList]="actionList" [rol]="rol" [parent_id]="action._id" [editMode]="editMode" [nLevel]="nLevelChilds"
                          (uploaded)="updateParent()" (onUpdatedActionList)="updateActionList()" (onNewChild)="newChildEmiter()">
    </app-action-list-item>
  </div>
</ng-container>

  <ng-template #checkedTemplate><span nz-icon nzType="check"></span></ng-template>
  <ng-template #unCheckedTemplate><span nz-icon nzType="close"></span></ng-template>
  